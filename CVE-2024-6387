#!/bin/bash env python3

'''cve-2024-6387-regresshion
   dork :product:"OpenSSH"
'''

import socket
import sys

def main(ip,check,vuln):
    
     checker=[True if check in vuln else None]
     if not None:

      print(f'\n\033[32m{ip} Vulnerable version !')
  

   
     
if __name__=='__main__':
  
  
  
  addr_info = socket.getaddrinfo(sys.argv[1], None)
  ip_check = socket.AF_INET6 if ':' in sys.argv[1] else socket.AF_INET
     
  sock = socket.socket(ip_check, socket.SOCK_STREAM)
  sock.connect((sys.argv[1], 22)) 
  banner=sock.recv(1024).decode(errors='ignore').strip() 

     


  vuln_versions = [
        'SSH-2.0-OpenSSH_1','SSH-2.0-OpenSSH_2','SSH-2.0-OpenSSH_3','SSH-2.0-OpenSSH_4.0','SSH-2.0-OpenSSH_4.1','SSH-2.0-OpenSSH_4.2','SSH-2.0-OpenSSH_4.3','SSH-2.0-OpenSSH_4.4','SSH-2.0-OpenSSH_8.5','SSH-2.0-OpenSSH_8.6','SSH-2.0-OpenSSH_8.7''SSH-2.0-OpenSSH_8.8','SSH-2.0-OpenSSH_8.9',
        'SSH-2.0-OpenSSH_9.0','SSH-2.0-OpenSSH_9.1','SSH-2.0-OpenSSH_9.2','SSH-2.0-OpenSSH_9.3','SSH-2.0-OpenSSH_9.4','SSH-2.0-OpenSSH_9.5','SSH-2.0-OpenSSH_9.6','SSH-2.0-OpenSSH_9.7']

  fixed_versions = [
        'SSH-2.0-OpenSSH_8.9p1 Ubuntu-3ubuntu0.10','SSH-2.0-OpenSSH_9.3p1 Ubuntu-3ubuntu3.6','SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.3','SSH-2.0-OpenSSH_9.6p1 Ubuntu-3ubuntu13.4','SSH-2.0-OpenSSH_9.3p1 Ubuntu-1ubuntu3.6','SSH-2.0-OpenSSH_9.2p1 Debian-2+deb12u3','SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u3','SSH-2.0-OpenSSH_9.7p1 Debian-7',
        'SSH-2.0-OpenSSH_9.6 FreeBSD-20240701','SSH-2.0-OpenSSH_9.7 FreeBSD-20240701']

  main(sys.argv[1],banner,vuln_versions)

